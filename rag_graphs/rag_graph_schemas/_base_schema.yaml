state_type:
    id: _base_state_graph
    module_path: state_graphs._base_state_graph
    class_name: BaseStateGraph

entry_point: get_user_metadata

nodes:
  - id: get_user_metadata
    module_path: nodes.get_user_metadata
    function_name: main

  - id: reformulate_question
    module_path: nodes.reformulate_question
    function_name: main

  - id: classify_question
    module_path: nodes.classify_question
    function_name: main

  - id: generate_static_answer
    module_path: nodes.get_static_answer
    function_name: main

  - id: retrieve_documents
    module_path: nodes.retrieve_documents
    function_name: main

  - id: rerank_documents
    module_path: nodes.rerank_documents
    function_name: main

  - id: generate_llm_answer
    module_path: nodes.generate_llm_answer
    function_name: main

edges:
  - from_node: get_user_metadata
    to_node: reformulate_question

  - from_node: reformulate_question
    to_node: classify_question

  - from_node: classify_question
    condition:
        id: classify_question
        module_path: nodes.classify_question
        function_name: main
    mapping:
      OFF_TOPIC: generate_static_answer
      TOPIC: retrieve_documents

### STATIC ANSWER
  - from_node: generate_static_answer
    to_node: __end__

### RETRIEVAL AUGMENTED GENERATION
  - from_node: retrieve_documents
    to_node: rerank_documents

  - from_node: rerank_documents
    to_node: generate_llm_answer

  - from_node: generate_llm_answer
    to_node: __end__
